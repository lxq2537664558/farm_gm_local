<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>产品列表</title>
    <link rel="stylesheet" href="__PUBLIC__/assets/css/amazeui.css" />
    <link rel="stylesheet" href="__PUBLIC__/assets/css/admin.css" />
</head>
<body>
<div class="admin" style="width: 100%; height: 100%;">
    <include file="Common@Common:sidebar" />
    <div class="content-page" style="position: absolute; left: 15%; width:85%;">
        <!-- 标题 -->
        <h2 class="title" style="margin-top: 35px; margin-left: 10px;">产品列表</h2>
        <!-- 表格导出 -->
        <button class="out_excel">表格导出为excel</button>
        <!-- 内容 -->
        <div class="products-list">
            <table id="mytable" style="width: 100%;" border="1">
                <thead>
                <tr>
                    <th>id</th>
                    <th>产品名称</th>
                    <th>初始价格</th>
                    <!--<th>创建时间</th>-->
                    <th>状态</th>
                    <!--<th>操作</th>-->
                </tr>
                </thead>
                <tbody>
                <foreach name="products" item="p">
                    <tr>
                        <td>{$p['id']}</td>
                        <td>{$p['name']}</td>
                        <td>{$p['price']}</td>
                        <!--<td>2017-01-01</td>-->
                        <td>交易所产品</td>
                    </tr>
                </foreach>
                </tbody>
            </table>
        </div>
    </div>
</div>
<script type="text/javascript" src="__PUBLIC__/assets/js/jquery-2.1.0.js" ></script>
<script type="text/javascript" src="__PUBLIC__/assets/js/amazeui.min.js"></script>
<script type="text/javascript" src="__PUBLIC__/assets/js/tableExport.js"></script>
<script type="text/javascript">
    $('#collapse-nav1').addClass('am-in');
    // $('.out_excel').click(function(){
    //     window.location = "http://www.jiyu-keji.com/farm/index.php?m=Home&c=Product&a=downProductList";
    // })

    $(".out_excel").click(function(){

        $('#mytable').tableExport({

        type:'excel',

        escape:'false',

        fileName: '产品列表'

        });

    });


     // var idTmr;
     //    function  getExplorer() {
     //        var explorer = window.navigator.userAgent ;
     //        //ie
     //        if (explorer.indexOf("MSIE") >= 0) {
     //            return 'ie';
     //        }
     //        //firefox
     //        else if (explorer.indexOf("Firefox") >= 0) {
     //            return 'Firefox';
     //        }
     //        //Chrome
     //        else if(explorer.indexOf("Chrome") >= 0){
     //            return 'Chrome';
     //        }
     //        //Opera
     //        else if(explorer.indexOf("Opera") >= 0){
     //            return 'Opera';
     //        }
     //        //Safari
     //        else if(explorer.indexOf("Safari") >= 0){
     //            return 'Safari';
     //        }
     //    }
     //    function method5(tableid) {
     //        if(getExplorer()=='ie')
     //        {
     //            var curTbl = document.getElementById(tableid);
     //            var oXL = new ActiveXObject("Excel.Application");
     //            var oWB = oXL.Workbooks.Add();
     //            var xlsheet = oWB.Worksheets(1);
     //            var sel = document.body.createTextRange();
     //            sel.moveToElementText(curTbl);
     //            sel.select();
     //            sel.execCommand("Copy");
     //            xlsheet.Paste();
     //            oXL.Visible = true;

     //            try {
     //                var fname = oXL.Application.GetSaveAsFilename("Excel.xls", "Excel Spreadsheets (*.xls), *.xls");
     //            } catch (e) {
     //                print("Nested catch caught " + e);
     //            } finally {
     //                oWB.SaveAs(fname);
     //                oWB.Close(savechanges = false);
     //                oXL.Quit();
     //                oXL = null;
     //                idTmr = window.setInterval("Cleanup();", 1);
     //            }

     //        }
     //        else
     //        {
     //            tableToExcel('mytable');
     //        }
     //    }
     //    function Cleanup() {
     //        window.clearInterval(idTmr);
     //        CollectGarbage();
     //    }
     //    var tableToExcel = (function() {
     //        var uri = 'data:application/vnd.ms-excel;base64,',
     //                template = '<html><head><meta charset="UTF-8"></head><body><table>{table}</table></body></html>',
     //                base64 = function(s) { return window.btoa(unescape(encodeURIComponent(s))) },
     //                format = function(s, c) {
     //                    return s.replace(/{(\w+)}/g,
     //                            function(m, p) { return c[p]; }) }
     //        return function(table, name) {
     //            if (!table.nodeType) table = document.getElementById(table)
     //            var ctx = {worksheet: name || 'Worksheet', table: table.innerHTML}
     //            window.location.href = uri + base64(format(template, ctx))
     //        }
     //    })()




</script>
<script type="text/javascript" src="__PUBLIC__/assets/js/nav.js"></script>
</body>
</html>
